---
title: Spring
categories:
- Java
tags:
- Java
- Spring
abbrlink: 40398
---
[Spring | Home](https://spring.io/)

## 01.Spring框架简介

### Spring 概述

Spring是分层的Java SE/EE应用 full-stack轻量级开源框架，以`IoC（Inverse Of Control：反转控制）`和`AOP（Aspect Oriented Programming：面向切面编程）`为内核，提供了展现层Spring MVC和持久层Spring JDBC以及业务层事务管理等众多的企业级应用技术，还能整合开源世界众多著名的第三方框架和类库，逐渐成为使用最多的Java EE企业应用开源框架。

### Spring 发展历程

>1997年IBM提出了EJB的思想
>1998年，SUN制定开发标准规范EJB1.0
>1999年，EJB1.1发布
>2001年，EJB2.0发布
>2003年，EJB2.1发布
>2006年，EJB3.0发布
>Rod Johnson（spring之父）
>Expert One-to-One J2EE Design and Development(2002)
>阐述了J2EE使用EJB开发设计的优点及解决方案
>Expert One-to-One J2EE Development without EJB(2004)
>阐述了J2EE开发不使用EJB的解决方式（Spring雏形）
>2017年9月份发布了spring的最新版本spring 5.0通用版（GA）

### Spring 的优势

- 方便解耦，简化开发
	通过Spring提供的IoC容器，可以将对象间的依赖关系交由Spring进行控制，避免硬编码所造成的过度程序耦合。用户也不必再为单例模式类、属性文件解析等这些很底层的需求编写代码，可以更专注于上层的应用。
- AOP编程的支持
	通过Spring的AOP功能，方便进行面向切面的编程，许多不容易用传统OOP实现的功能可以通过AOP轻松应付。

- 声明式事务的支持
	可以将我们从单调烦闷的事务管理代码中解脱出来，通过声明式方式灵活的进行事务的管理，提高开发效率和质量。
- 方便程序的测试
	可以用非容器依赖的编程方式进行几乎所有的测试工作，测试不再是昂贵的操作，而是随手可做的事情。
- 方便集成各种优秀框架
	Spring可以降低各种框架的使用难度，提供了对各种优秀框架（Struts、Hibernate、Hessian、Quartz等）的直接支持。
- 降低JavaEE API的使用难度
	Spring对JavaEE API（如JDBC、JavaMail、远程调用等）进行了薄薄的封装层，使这些API的使用难度大为降低。
- Java源码是经典学习范例
	Spring的源代码设计精妙、结构清晰、匠心独用，处处体现着大师对Java设计模式灵活运用以及对Java技术的高深造诣。它的源代码无意是Java技术的最佳实践的范例。

### 体系结构

![image-20200808143856766](https://i.loli.net/2020/08/08/c7WAnf25RZYiwlq.png)

## 02.程序间耦合

### 什么是程序的耦合

耦合性(Coupling)，也叫耦合度，是对模块间关联程度的度量。耦合的强弱取决于模块间接口的复杂性、调用模块的方式以及通过界面传送数据的多少。模块间的耦合度是指模块之间的依赖关系，包括控制关系、调用关系、数据传递关系。`模块间联系越多，其耦合性越强，同时表明其独立性越差( 降低耦合性，可以提高其独立性)`。耦合性存在于各个领域，而非软件设计中独有的，但是我们只讨论软件工程中的耦合。 在软件工程中，耦合指的就是就是对象之间的依赖性。对象之间的耦合越高，维护成本越高。因此对象的设计应使类和构件之间的耦合最小。软件设计中通常用耦合度和内聚度作为衡量模块独立程度的标准。划分模块的一个准则就是高内聚低耦合。 它有如下分类： 

（1） 内容耦合。当一个模块直接修改或操作另一个模块的数据时，或一个模块不通过正常入口而转入另一个模块时，这样的耦合被称为内容耦合。内容耦合是最高程度的耦合，应该避免使用之。 

（2） 公共耦合。两个或两个以上的模块共同引用一个全局数据项，这种耦合被称为公共耦合。在具有大量公共耦合的结构中，确定究竟是哪个模块给全局变量赋了一个特定的值是十分困难的。 

（3） 外部耦合 。一组模块都访问同一全局简单变量而不是同一全局数据结构，而且不是通过参数表传递该全局变量的信息，则称之为外部耦合。

 （4） 控制耦合 。一个模块通过接口向另一个模块传递一个控制信号，接受信号的模块根据信号值而进行适当的动作，这种耦合被称为控制耦合。 

（5） 标记耦合 。若一个模块A通过接口向两个模块B和C传递一个公共参数，那么称模块B和C之间存在一个标记耦合。 

（6） 数据耦合。模块之间通过参数来传递数据，那么被称为数据耦合。数据耦合是最低的一种耦合形式，系统中一般都存在这种类型的耦合，因为为了完成一些有意义的功能，往往需要将某些模块的输出数据作为另一些模块的输入数据。 

（7） 非直接耦合 。两个模块之间没有直接关系，它们之间的联系完全是通过主模块的控制和调用来实现的。

 总结： 

耦合是影响软件复杂程度和设计质量的一个重要因素，在设计上我们应采用以下原则：如果模块间必须存在耦合，就尽量使用数据耦合，少用控制耦合，限制公共耦合的范围，尽量避免使用内容耦合。 

`内聚与耦合 `

内聚标志一个模块内各个元素彼此结合的紧密程度，它是信息隐蔽和局部化概念的自然扩展。内聚是从功能角度来度量模块内的联系，一个好的内聚模块应当恰好做一件事。它描述的是模块内的功能联系。耦合是软件结构中各模块之间相互连接的一种度量，耦合强弱取决于模块间接口的复杂程度、进入或访问一个模块的点以及通过接口的数据。 程序讲究的是低耦合，高内聚。就是同一个模块内的各个元素之间要高度紧密，但是各个模块之间的相互依存度却要不那么紧密。 内聚和耦合是密切相关的，同其他模块存在高耦合的模块意味着低内聚，而高内聚的模块意味着该模块同其他模块之间是低耦合。在进行软件设计时，应力争做到高内聚，低耦合

## 03.Spring的 IoC 和 DI

### IoC的概念和作用

我们在开发中，有些依赖关系是必须的，有些依赖关系可以通过优化代码来解除的。

```java
public class Account ServiceImpl implements IAccountService{
	private IAccountDao accountDao = new AccountDaoImpl();
}
```

上面的代码表示： 业务层调用持久层，并且此时业务层在依赖持久层的接口和实现类。如果此时没有持久层实现类，编译将不能通过。这种编译期依赖关系，应该在我们开发中杜绝。我们需要优化代码解决。

再比如： 早期我们的JDBC操作，注册驱动时，我们为什么不使用DriverManager的register方法，而是采用Class.forName的方式？

```java
public class JdbcDemo01{
	public static void main(String[] args) throws Exception{
		//DriverManager.registerDriver(new com.mysql.jdbc.Driver());
		// 注册驱动
		Class.forName("com.mysql.jdbc.Driver")
		// 获取连接
		// 获取预处理sql语句对象
		// 获取结果集
		// 遍历结构集	
	}
}
```

原因就是： 我们的类依赖了数据库的具体驱动类（MySQL），如果这时候更换了数据库品牌（比如Oracle），需要修改源码来重新数据库驱动。这显然不是我们想要的。

### 解决程序耦合的思路

当是我们讲解jdbc时，是通过反射来注册驱动的，代码如下：

```java
Class.forName("com.mysql.jdbc.Driver");//此处只是一个字符串
```

此时的好处是，我们的类中不再依赖具体的驱动类，此时就算删除mysql的驱动jar包，依然可以编译（运行就不要想了，没有驱动不可能运行成功的）。 同时，也产生了一个新的问题，mysql驱动的全限定类名字符串是在java类中写死的，一旦要改还是要修改源码。 解决这个问题也很简单，使用配置文件配置。

### 工厂模式解耦

在实际开发中我们可以把三层的对象都使用配置文件配置起来，当启动服务器应用加载的时候，让一个类中的方法通过读取配置文件，把这些对象创建出来并存起来，在接下来的使用的时候，直接拿过来用就好了。 那么，这个读取配置文件，创建和获取三层对象的类就是工厂。

### 控制反转-Inversion Of Control

控制反转（Inversion of Control，英文 Ioc） 把创建对象的权利交给框架，是框架的重要特征，并非面向对象编程的专用术语。它包括依赖注入（Dependency Injection 简称DI） 和依赖查找（Dependency Lookup）

1、存哪去？ 

分析：由于我们是很多对象，肯定要找个集合来存。这时候有Map和List供选择。 到底选Map还是List就看我们有没有查找需求。有查找需求，选Map。 所以我们的答案就是 在应用加载时，创建一个Map，用于存放三层对象。 我们把这个map称之为容器。

 2、还是没解释什么是工厂？ 

工厂就是负责给我们从容器中获取指定对象的类。这时候我们获取对象的方式发生了改变。 原来： 我们在获取对象时，都是采用new的方式。是主动的。

![image-20200808150747723](https://i.loli.net/2020/08/08/vBFnt1okeG3CldQ.png)



现在： 我们获取对象时，同时跟工厂要，有工厂为我们查找或者创建对象。是被动的。

![image-20200808150808556](https://i.loli.net/2020/08/08/ceH7SdLkRPhVsw2.png)

明确ioc的作用： 削减计算机程序的耦合(解除我们代码中的依赖关系)。

### 使用spring 的IOC 解决程序的耦合

准备spring的开发包

官网：http://spring.io/ 

下载地址： http://repo.springsource.org/libs-release-local/org/springframework/spring 

解压:

```
(Spring目录结构:) * docs :API和开发规范.
libs :jar包和源码. 
* schema :约束.
```



## 04.Spring的常用注解

## 05.基于XML的IOC的案例

## 06.Spring的新注解

## 07.银行转账案例

## 08.面向切面编程 AOP

## 09.JdbcTemplate的基本使用

## 10.Spring中事务控制

